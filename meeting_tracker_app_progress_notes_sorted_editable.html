<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Flameco Meeting Tracker</title>
<style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #6ccff6;
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Login Screen */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-box h1 {
            margin-bottom: 30px;
            color: #6ccff6;
            font-size: 2.5em;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e1e1;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #6ccff6;
        }

        .btn {
            background: #6ccff6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform 0.2s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-success {
            background: #28a745;
        }

        /* Main App */
        .app-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-top: 20px;
        }

        .header {
            background: #6ccff6;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 2em;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-buttons button {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .nav-buttons button:hover, .nav-buttons button.active {
            background: rgba(255,255,255,0.3);
        }

        .content {
            padding: 30px;
        }

        /* Search and Filters */
        .search-filters {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        /* Meeting List */
        .meeting-list {
            display: grid;
            gap: 20px;
        }

        .meeting-card {
            background: white;
            border: 1px solid #e1e1e1;
            border-radius: 8px;
            padding: 20px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .meeting-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .meeting-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .meeting-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .meeting-date {
            color: #6ccff6;
            font-weight: 500;
        }

        .meeting-actions {
            display: flex;
            gap: 5px;
        }

        .meeting-actions button {
            padding: 5px 10px;
            font-size: 12px;
            border-radius: 4px;
        }

        .meeting-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        .detail-item {
            font-size: 14px;
        }

        .detail-label {
            font-weight: 600;
            color: #555;
        }

        .detail-value {
            color: #333;
            margin-left: 5px;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f1f1f1;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        /* Progress Notes */
        .notes-section {
            margin-top: 20px;
            border-top: 2px solid #f1f1f1;
            padding-top: 20px;
        }

        .notes-timeline {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e1e1e1;
            border-radius: 6px;
            padding: 10px;
            background: #fafafa;
        }

        .note-item {
            background: white;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 6px;
            border-left: 4px solid #6ccff6;
        }

        .note-date {
            font-size: 12px;
            color: #999;
            font-weight: 600;
        }

        .note-content {
            margin-top: 5px;
        }

        /* File attachments */
        .attachments {
            margin-top: 15px;
        }

        .attachment-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .attachment-item {
            background: #f8f9fa;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .attachment-remove {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            cursor: pointer;
            font-size: 10px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 10px;
            }

            .nav-buttons {
                flex-wrap: wrap;
                justify-content: center;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .search-filters {
                grid-template-columns: 1fr;
            }

            .meeting-details {
                grid-template-columns: 1fr;
            }
        }

        .hidden {
            display: none !important;
        }

        .export-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
<!-- Login Screen -->
<div class="login-container" id="loginScreen">
<div class="login-box">
<h1>Flameco Meeting Tracker</h1>
<div class="form-group">
<label for="password">Password:</label>
<input id="password" placeholder="Enter your password" type="password"/>
</div>
<button class="btn" onclick="login()">Login</button>
</div>
</div>
<!-- Main Application -->
<div class="hidden" id="mainApp">
<div class="container">
<div class="app-container">
<div class="header">
<h1>Flameco Meeting Tracker</h1>
<div class="nav-buttons">
<button class="active" onclick="showSection('dashboard')">Dashboard</button>
<button onclick="showSection('add')">Add Meeting</button>
<button onclick="showSection('export')">Export</button>
<button onclick="logout()">Logout</button>
</div>
</div>
<div class="content">
<!-- Dashboard Section -->
<div id="dashboardSection">
<div class="search-filters">
<div class="form-group">
<label>Search:</label>
<input id="searchInput" onkeyup="filterMeetings()" placeholder="Search meetings..." type="text"/>
</div>
<div class="form-group">
<label>Filter by Company:</label>
<select id="companyFilter" onchange="filterMeetings()">
<option value="">All Companies</option>
</select>
</div>
<div class="form-group">
<label>Filter by Product:</label>
<select id="productFilter" onchange="filterMeetings()">
<option value="">All Products</option>
</select>
</div>
<div class="form-group">
<label>Date From:</label>
<input id="dateFromFilter" onchange="filterMeetings()" type="date"/>
</div>
<div class="form-group">
<label>Date To:</label>
<input id="dateToFilter" onchange="filterMeetings()" type="date"/>
</div>
<div class="form-group">
<label>Filter by Added by:</label>
<select id="addedByFilter" onchange="filterMeetings()">
<option value="">All</option>
</select>
</div>
</div>
<div class="meeting-list" id="meetingsList">
<p style="text-align: center; color: #999; padding: 40px;">No meetings found. Click "Add Meeting" to get started.</p>
</div>
</div>
<!-- Export Section -->
<div class="hidden" id="exportSection">
<div class="export-section">
<h2>Export Data</h2>
<p>Export your meeting data in different formats:</p>
<div class="export-buttons">
<button class="btn btn-success" onclick="exportToExcel()">Export to Excel</button>
<button class="btn btn-secondary" onclick="exportToPDF()">Export to PDF</button>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- Meeting Modal -->
<div class="modal hidden" id="meetingModal">
<div class="modal-content">
<div class="modal-header">
<h2 id="modalTitle">Add New Meeting</h2>
<button class="close-btn" onclick="closeMeetingModal()">×</button>
</div>
<form id="meetingForm" onsubmit="saveMeeting(event)">
<div class="form-grid">
<div class="form-group">
<label for="meetingDate">Meeting Date *</label>
<input id="meetingDate" required="" type="date"/>
</div>
<div class="form-group">
<label for="companyName">Company Name *</label>
<input id="companyName" required="" type="text"/>
</div>
<div class="form-group">
<label for="attendeeFromFlameco">Attendee from Flameco *</label>
<input id="attendeeFromFlameco" required="" type="text"/>
</div>
<div class="form-group">
<label for="attendeesFromClient">Attendees from client *</label>
<input id="attendeesFromClient" required="" type="text"/>
</div>
<div class="form-group">
<label for="emailAddress">Email Address</label>
<input id="emailAddress" type="email"/>
</div>
<div class="form-group">
<label for="contactNumber">Contact number</label>
<input id="contactNumber" type="tel"/>
</div>
<div class="form-group">
<label for="productName">Product Name *</label>
<input id="productName" required="" type="text"/>
</div>
<div class="form-group">
<label for="location">Location *</label>
<input id="location" required="" type="text"/>
</div>
<div class="form-group">
<label for="addedBy">Added by *</label>
<input id="addedBy" required="" type="text"/>
</div>
</div>
<div class="form-group">
<label for="notes">Meeting Notes *</label>
<textarea id="notes" required="" rows="4"></textarea>
</div>
<div class="form-group">
<label for="attachments">Attachments</label>
<input accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" id="attachments" multiple="" type="file"/>
<div class="attachment-list" id="attachmentsList"></div>
</div>
<!-- Progress Notes Section -->
<div class="notes-section">
<h3>Progress Notes</h3>
<div class="form-group"><label for="progressNoteDate">Progress Note Date *</label><input id="progressNoteDate" type="date"/><br/>
<label for="dailyNote">Add Progress Note</label>
<textarea id="dailyNote" placeholder="Add a note about today's progress..." rows="2"></textarea>
<button class="btn btn-secondary" onclick="addProgressNote()" style="margin-top: 10px;" type="button">Add Note</button>
</div>
<div class="notes-timeline" id="notesTimeline">
<p style="color: #999; text-align: center;">No progress notes yet.</p>
</div>
</div>
<div style="margin-top: 30px; text-align: right;">
<button class="btn btn-secondary" onclick="closeMeetingModal()" type="button">Cancel</button>
<button class="btn" type="submit">Save Meeting</button>
</div>
</form>
</div>
</div>
<!-- View Meeting Modal -->
<div class="modal hidden" id="viewMeetingModal">
<div class="modal-content">
<div class="modal-header">
<h2>Meeting Details</h2>
<button class="close-btn" onclick="closeViewMeetingModal()">×</button>
</div>
<div id="viewMeetingContent">
<!-- Meeting details will be populated here -->
</div>
</div>
</div>
<script>
        // Application state
        let meetings = [];
        let currentEditingId = null;
        let currentSection = 'dashboard';
        const PASSWORD = 'meeting123';

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            loadMeetings();
        });

        // Authentication
        function login() {
            const password = document.getElementById('password').value;
            if (password === PASSWORD) {
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                loadMeetings();
            } else {
                alert('Incorrect password. Please try again.');
            }
        }

        function logout() {
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('password').value = '';
        }

        // Navigation
        function showSection(section) {
            // Update active button
            document.querySelectorAll('.nav-buttons button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Hide all sections
            document.getElementById('dashboardSection').classList.add('hidden');
            document.getElementById('exportSection').classList.add('hidden');

            // Show selected section
            if (section === 'dashboard') {
                document.getElementById('dashboardSection').classList.remove('hidden');
                displayMeetings();
            } else if (section === 'add') {
                openMeetingModal();
            } else if (section === 'export') {
                document.getElementById('exportSection').classList.remove('hidden');
            }

            currentSection = section;
        }

        // Meeting Management
        function openMeetingModal(meetingId = null) {
            currentEditingId = meetingId;
            const modal = document.getElementById('meetingModal');
            const modalTitle = document.getElementById('modalTitle');
            const form = document.getElementById('meetingForm');
            
            if (meetingId) {
                modalTitle.textContent = 'Edit Meeting';
                const meeting = meetings.find(m => m.id === meetingId);
                if (meeting) {
                    populateForm(meeting);
                }
            } else {
                modalTitle.textContent = 'Add New Meeting';
                form.reset();
                document.getElementById('attachmentsList').innerHTML = '';
                document.getElementById('notesTimeline').innerHTML = '<p style="color: #999; text-align: center;">No progress notes yet.</p>';
            }
            
            modal.classList.remove('hidden');
        }

        function closeMeetingModal() {
            document.getElementById('meetingModal').classList.add('hidden');
            currentEditingId = null;
        }

        function populateForm(meeting) {
            document.getElementById('meetingDate').value = meeting.meetingDate;
            document.getElementById('companyName').value = meeting.companyName;
            document.getElementById('attendeeFromFlameco').value = meeting.attendeeFromFlameco;
            document.getElementById('attendeesFromClient').value = meeting.attendeesFromClient;
            document.getElementById('emailAddress').value = meeting.emailAddress || '';
            document.getElementById('contactNumber').value = meeting.contactNumber || '';
            document.getElementById('productName').value = meeting.productName;
            document.getElementById('location').value = meeting.location;
            document.getElementById('notes').value = meeting.notes;
            document.getElementById('addedBy').value = meeting.addedBy;
            
            // Display attachments
            displayAttachments(meeting.attachments || []);
            
            // Display progress notes
            displayProgressNotes(meeting.progressNotes || []);
        }

        function saveMeeting(event) {
            event.preventDefault();
            
            const meetingData = {
                id: currentEditingId || Date.now().toString(),
                meetingDate: document.getElementById('meetingDate').value,
                companyName: document.getElementById('companyName').value,
                attendeeFromFlameco: document.getElementById('attendeeFromFlameco').value,
                attendeesFromClient: document.getElementById('attendeesFromClient').value,
                emailAddress: document.getElementById('emailAddress').value,
                contactNumber: document.getElementById('contactNumber').value,
                productName: document.getElementById('productName').value,
                location: document.getElementById('location').value,
                notes: document.getElementById('notes').value,
                addedBy: document.getElementById('addedBy').value,
                attachments: getAttachments(),
                progressNotes: getProgressNotes(),
                createdAt: currentEditingId ? meetings.find(m => m.id === currentEditingId).createdAt : new Date().toISOString()
            };

            if (currentEditingId) {
                const index = meetings.findIndex(m => m.id === currentEditingId);
                meetings[index] = meetingData;
            } else {
                meetings.push(meetingData);
            }

            saveMeetings();
            closeMeetingModal();
            displayMeetings();
            updateFilterOptions();
        }

        function deleteMeeting(meetingId) {
            if (confirm('Are you sure you want to delete this meeting?')) {
                meetings = meetings.filter(m => m.id !== meetingId);
                saveMeetings();
                displayMeetings();
                updateFilterOptions();
            }
        }

        // View Meeting Modal
        function openViewMeetingModal(meetingId) {
            const meeting = meetings.find(m => m.id === meetingId);
            if (!meeting) return;

            const modal = document.getElementById('viewMeetingModal');
            const content = document.getElementById('viewMeetingContent');
            
            content.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <div class="detail-item">
                        <span class="detail-label">Meeting Date:</span>
                        <span class="detail-value">${formatDate(meeting.meetingDate)}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Company Name:</span>
                        <span class="detail-value">${meeting.companyName}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Attendee from Flameco:</span>
                        <span class="detail-value">${meeting.attendeeFromFlameco}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Attendees from client:</span>
                        <span class="detail-value">${meeting.attendeesFromClient}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Product Name:</span>
                        <span class="detail-value">${meeting.productName}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Location:</span>
                        <span class="detail-value">${meeting.location}</span>
                    </div>
                    ${meeting.emailAddress ? `
                        <div class="detail-item">
                            <span class="detail-label">Email Address:</span>
                            <span class="detail-value">${meeting.emailAddress}</span>
                        </div>
                    ` : ''}
                    ${meeting.contactNumber ? `
                        <div class="detail-item">
                            <span class="detail-label">Contact Number:</span>
                            <span class="detail-value">${meeting.contactNumber}</span>
                        </div>
                    ` : ''}
                    <div class="detail-item">
                        <span class="detail-label">Added by:</span>
                        <span class="detail-value">${meeting.addedBy}</span>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <div class="detail-label" style="margin-bottom: 10px;">Meeting Notes:</div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #6ccff6;">
                        ${meeting.notes}
                    </div>
                </div>
                
                ${meeting.attachments && meeting.attachments.length > 0 ? `
                    <div style="margin-bottom: 20px;">
                        <div class="detail-label" style="margin-bottom: 10px;">Attachments:</div>
                        <div class="attachment-list">
                            ${meeting.attachments.map(att => `
                                <div class="attachment-item" style="cursor: pointer;" onclick="downloadAttachment('${att.name}')">
                                    📎 ${att.name}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                ` : ''}
                
                ${meeting.progressNotes && meeting.progressNotes.length > 0 ? `
                    <div>
                        <div class="detail-label" style="margin-bottom: 15px;">Progress Notes:</div>
                        <div class="notes-timeline">
                            ${meeting.progressNotes.map(note => `
                                <div class="note-item">
                                    <div class="note-date">${note.date}</div>
                                    <div class="note-content">${note.content}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                ` : '<div style="text-align: center; color: #999;">No progress notes available.</div>'}
            `;
            
            modal.classList.remove('hidden');
        }

        function closeViewMeetingModal() {
            document.getElementById('viewMeetingModal').classList.add('hidden');
        }

        function downloadAttachment(filename) {
            alert(`In a real application, this would download: ${filename}`);
        }

        // Progress Notes Management
        function addProgressNote() {
            const noteText = document.getElementById('dailyNote').value.trim();
            if (!noteText) {
                alert('Please enter a note.');
                return;
            }

            const noteDate = document.getElementById('progressNoteDate').value.trim();
            const note = {
                date: noteDate || '',
                content: noteText
            };

            let currentNotes = getProgressNotes();
            currentNotes.unshift(note);
            
            displayProgressNotes(currentNotes);
            document.getElementById('dailyNote').value = '';
        }

        function getProgressNotes() {
            const notesTimeline = document.getElementById('notesTimeline');
            const noteItems = notesTimeline.querySelectorAll('.note-item');
            const notes = [];
            
            noteItems.forEach(item => {
                const dateTime = item.querySelector('.note-date').textContent;
                const content = item.querySelector('.note-content').textContent;
                notes.push({
                    date: dateTime.split(' at ')[0],
                    time: dateTime.split(' at ')[1],
                    content: content
                });
            });
            
            return notes;
        }

        
function displayProgressNotes(notes) {
    const timeline = document.getElementById('notesTimeline');

    if (notes.length === 0) {
        timeline.innerHTML = '<p style="color: #999; text-align: center;">No progress notes yet.</p>';
        return;
    }

    // Sort by date ascending (empty dates stay at the end)
    notes.sort((a, b) => {
        if (!a.date) return 1;
        if (!b.date) return -1;
        return new Date(a.date) - new Date(b.date);
    });

    timeline.innerHTML = notes.map((note, index) => `
        <div class="note-item" data-index="${index}">
            <div class="note-date">${note.date ? note.date : ''}</div>
            <div class="note-content">${note.content}</div>
            <button type="button" class="btn btn-secondary" style="margin-top:5px;" onclick="editProgressNote(${index})">Edit</button>
        </div>
    `).join('');
}


        // Attachment Management
        function getAttachments() {
            const attachmentsList = document.getElementById('attachmentsList');
            const attachmentItems = attachmentsList.querySelectorAll('.attachment-item');
            const attachments = [];
            
            attachmentItems.forEach(item => {
                const filename = item.textContent.replace('×', '').trim();
                attachments.push({ name: filename, size: 'Unknown' });
            });
            
            return attachments;
        }

        function displayAttachments(attachments) {
            const attachmentsList = document.getElementById('attachmentsList');
            attachmentsList.innerHTML = attachments.map(att => `
                <div class="attachment-item">
                    ${att.name}
                    <button type="button" class="attachment-remove" onclick="removeAttachment(this)">×</button>
                </div>
            `).join('');
        }

        function removeAttachment(button) {
            button.parentElement.remove();
        }

        // File input handling
        document.getElementById('attachments').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            const attachmentsList = document.getElementById('attachmentsList');
            
            files.forEach(file => {
                const attachmentItem = document.createElement('div');
                attachmentItem.className = 'attachment-item';
                attachmentItem.innerHTML = `
                    ${file.name}
                    <button type="button" class="attachment-remove" onclick="removeAttachment(this)">×</button>
                `;
                attachmentsList.appendChild(attachmentItem);
            });
            
            e.target.value = '';
        });

        // Display and Filter Functions
        function displayMeetings() {
            const meetingsList = document.getElementById('meetingsList');
            const filteredMeetings = getFilteredMeetings();
            
            if (filteredMeetings.length === 0) {
                meetingsList.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">No meetings found.</p>';
                return;
            }

            meetingsList.innerHTML = filteredMeetings.map(meeting => `
                <div class="meeting-card">
                    <div class="meeting-header">
                        <div>
                            <div class="meeting-title">${meeting.companyName}</div>
                            <div class="meeting-date">${formatDate(meeting.meetingDate)}</div>
                        </div>
                        <div class="meeting-actions">
                            <button class="btn btn-secondary" onclick="openViewMeetingModal('${meeting.id}')">View</button>
                            <button class="btn btn-secondary" onclick="openMeetingModal('${meeting.id}')">Edit</button>
                            <button class="btn btn-danger" onclick="deleteMeeting('${meeting.id}')">Delete</button>
                        </div>
                    </div>
                    
                    <div class="meeting-details">
                        <div class="detail-item">
                            <span class="detail-label">Flameco Attendee:</span>
                            <span class="detail-value">${meeting.attendeeFromFlameco}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Client Attendees:</span>
                            <span class="detail-value">${meeting.attendeesFromClient}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Product:</span>
                            <span class="detail-value">${meeting.productName}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Location:</span>
                            <span class="detail-value">${meeting.location}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Added by:</span>
                            <span class="detail-value">${meeting.addedBy}</span>
                        </div>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">Notes:</span>
                        <span class="detail-value">${meeting.notes.length > 100 ? meeting.notes.substring(0, 100) + '...' : meeting.notes}</span>
                    </div>
                    
                    ${meeting.attachments && meeting.attachments.length > 0 ? `
                        <div class="attachments">
                            <span class="detail-label">Attachments:</span>
                            <div class="attachment-list">
                                ${meeting.attachments.map(att => `<div class="attachment-item" style="cursor: pointer;" onclick="downloadAttachment('${att.name}')">📎 ${att.name}</div>`).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    ${meeting.progressNotes && meeting.progressNotes.length > 0 ? `
                        <div class="detail-item">
                            <span class="detail-label">Recent Progress:</span>
                            <span class="detail-value">${meeting.progressNotes[0].content}</span>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function getFilteredMeetings() {
            let filtered = [...meetings];
            
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const companyFilter = document.getElementById('companyFilter').value;
            const productFilter = document.getElementById('productFilter').value;
            const addedByFilter = document.getElementById('addedByFilter').value;
            const dateFrom = document.getElementById('dateFromFilter').value;
            const dateTo = document.getElementById('dateToFilter').value;
            
            if (searchTerm) {
                filtered = filtered.filter(meeting =>
                    meeting.companyName.toLowerCase().includes(searchTerm) ||
                    meeting.attendeeFromFlameco.toLowerCase().includes(searchTerm) ||
                    meeting.attendeesFromClient.toLowerCase().includes(searchTerm) ||
                    meeting.productName.toLowerCase().includes(searchTerm) ||
                    meeting.notes.toLowerCase().includes(searchTerm) ||
                    meeting.addedBy.toLowerCase().includes(searchTerm)
                );
            }
            
            if (companyFilter) {
                filtered = filtered.filter(meeting => meeting.companyName === companyFilter);
            }
            
            if (productFilter) {
                filtered = filtered.filter(meeting => meeting.productName === productFilter);
            }
            
            if (addedByFilter) {
                filtered = filtered.filter(meeting => meeting.addedBy === addedByFilter);
            }
            
            if (dateFrom) {
                filtered = filtered.filter(meeting => meeting.meetingDate >= dateFrom);
            }
            
            if (dateTo) {
                filtered = filtered.filter(meeting => meeting.meetingDate <= dateTo);
            }
            
            filtered.sort((a, b) => new Date(b.meetingDate) - new Date(a.meetingDate));
            
            return filtered;
        }

        function filterMeetings() {
            displayMeetings();
        }

        function updateFilterOptions() {
            const companies = [...new Set(meetings.map(m => m.companyName))].sort();
            const products = [...new Set(meetings.map(m => m.productName))].sort();
            const addedByList = [...new Set(meetings.map(m => m.addedBy))].sort();
            
            const companyFilter = document.getElementById('companyFilter');
            const productFilter = document.getElementById('productFilter');
            const addedByFilter = document.getElementById('addedByFilter');
            
            const currentCompany = companyFilter.value;
            const currentProduct = productFilter.value;
            const currentAddedBy = addedByFilter.value;
            
            companyFilter.innerHTML = '<option value="">All Companies</option>' +
                companies.map(company => `<option value="${company}">${company}</option>`).join('');
            
            productFilter.innerHTML = '<option value="">All Products</option>' +
                products.map(product => `<option value="${product}">${product}</option>`).join('');
            
            addedByFilter.innerHTML = '<option value="">All</option>' +
                addedByList.map(person => `<option value="${person}">${person}</option>`).join('');
            
            companyFilter.value = currentCompany;
            productFilter.value = currentProduct;
            addedByFilter.value = currentAddedBy;
        }

        // Export Functions
        function exportToExcel() {
            const csvContent = generateCSVContent();
            downloadFile(csvContent, 'meetings.csv', 'text/csv');
        }

        function exportToPDF() {
            const htmlContent = generatePDFContent();
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Flameco Meeting Tracker Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .meeting { margin-bottom: 30px; border-bottom: 1px solid #ccc; padding-bottom: 20px; }
                        .meeting-title { font-size: 18px; font-weight: bold; margin-bottom: 10px; }
                        .detail { margin-bottom: 5px; }
                        .label { font-weight: bold; }
                        .notes { margin-top: 10px; }
                        .progress-notes { margin-top: 15px; }
                        .note-item { background: #f5f5f5; padding: 5px; margin-bottom: 5px; border-radius: 3px; }
                        @media print { body { margin: 0; } }
                    </style>
                </head>
                <body>${htmlContent}</body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function generateCSVContent() {
            const headers = [
                'Meeting Date', 'Company Name', 'Attendee from Flameco', 'Attendees from Client',
                'Email Address', 'Contact Number', 'Product Name', 'Location', 'Notes', 'Added by', 'Attachments', 'Progress Notes Count'
            ];
            
            let csvContent = headers.join(',') + '\n';
            
            const dataToExport = getFilteredMeetings();
            
            dataToExport.forEach(meeting => {
                const row = [
                    meeting.meetingDate,
                    `"${meeting.companyName}"`,
                    `"${meeting.attendeeFromFlameco}"`,
                    `"${meeting.attendeesFromClient}"`,
                    `"${meeting.emailAddress || ''}"`,
                    `"${meeting.contactNumber || ''}"`,
                    `"${meeting.productName}"`,
                    `"${meeting.location}"`,
                    `"${meeting.notes.replace(/"/g, '""')}"`,
                    `"${meeting.addedBy}"`,
                    `"${(meeting.attachments || []).map(a => a.name).join('; ')}"`,
                    (meeting.progressNotes || []).length
                ];
                csvContent += row.join(',') + '\n';
            });
            
            return csvContent;
        }

        function generatePDFContent() {
            const dataToExport = getFilteredMeetings();
            
            let htmlContent = `
                <div class="header">
                    <h1>Flameco Meeting Tracker Report</h1>
                    <p>Generated on: ${formatDate(new Date().toISOString().split('T')[0])}</p>
                    <p>Total Meetings: ${dataToExport.length}</p>
                </div>
            `;
            
            dataToExport.forEach(meeting => {
                htmlContent += `
                    <div class="meeting">
                        <div class="meeting-title">${meeting.companyName} - ${formatDate(meeting.meetingDate)}</div>
                        <div class="detail"><span class="label">Attendee from Flameco:</span> ${meeting.attendeeFromFlameco}</div>
                        <div class="detail"><span class="label">Attendees from Client:</span> ${meeting.attendeesFromClient}</div>
                        ${meeting.emailAddress ? `<div class="detail"><span class="label">Email:</span> ${meeting.emailAddress}</div>` : ''}
                        ${meeting.contactNumber ? `<div class="detail"><span class="label">Contact:</span> ${meeting.contactNumber}</div>` : ''}
                        <div class="detail"><span class="label">Product:</span> ${meeting.productName}</div>
                        <div class="detail"><span class="label">Location:</span> ${meeting.location}</div>
                        <div class="detail"><span class="label">Added by:</span> ${meeting.addedBy}</div>
                        <div class="notes">
                            <div class="label">Meeting Notes:</div>
                            <div>${meeting.notes}</div>
                        </div>
                        ${meeting.attachments && meeting.attachments.length > 0 ? `
                            <div class="detail">
                                <span class="label">Attachments:</span> 
                                ${meeting.attachments.map(a => a.name).join(', ')}
                            </div>
                        ` : ''}
                        ${meeting.progressNotes && meeting.progressNotes.length > 0 ? `
                            <div class="progress-notes">
                                <div class="label">Progress Notes:</div>
                                ${meeting.progressNotes.slice(0, 5).map(note => `
                                    <div class="note-item">
                                        <strong>${note.date}:</strong> ${note.content}
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            });
            
            return htmlContent;
        }

        function downloadFile(content, filename, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Utility Functions
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // Data Persistence
        function saveMeetings() {
            // In-memory storage for demo
        }

        function loadMeetings() {
            if (meetings.length === 0) {
                meetings = [
                    {
                        id: '1',
                        meetingDate: '2025-08-01',
                        companyName: 'Tech Solutions Inc.',
                        attendeeFromFlameco: 'Sarah Johnson',
                        attendeesFromClient: 'John Smith (CTO), Mike Davis (Lead Developer)',
                        emailAddress: 'john.smith@techsolutions.com',
                        contactNumber: '+971-50-123-4567',
                        productName: 'Cloud Analytics Platform',
                        location: 'Dubai Office',
                        notes: 'Discussed implementation timeline and technical requirements. Client is interested in the advanced analytics features and requested a detailed proposal.',
                        addedBy: 'Ahmed Hassan',
                        attachments: [
                            { name: 'proposal.pdf', size: '2.3MB' },
                            { name: 'technical_specs.docx', size: '1.1MB' }
                        ],
                        progressNotes: [
                            {
                                date: '2025-08-10',
                                time: '2:30 PM',
                                content: 'Sent additional documentation as requested. Awaiting feedback on pricing structure.'
                            },
                            {
                                date: '2025-08-05',
                                time: '10:15 AM',
                                content: 'Follow-up call scheduled. Client requested demo of advanced features.'
                            }
                        ],
                        createdAt: '2025-08-01T10:00:00.000Z'
                    }
                ];
            }
            
            displayMeetings();
            updateFilterOptions();
        }

        // Event Listeners
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeMeetingModal();
                closeViewMeetingModal();
            }
        });

        document.getElementById('meetingModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeMeetingModal();
            }
        });

        document.getElementById('viewMeetingModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeViewMeetingModal();
            }
        });
    

function editProgressNote(index) {
    let notes = getProgressNotes();
    const note = notes[index];

    const newDate = prompt('Edit date (YYYY-MM-DD, leave blank for none):', note.date);
    const newContent = prompt('Edit note content:', note.content);

    if (newContent !== null) {
        notes[index] = {
            date: newDate ? newDate.trim() : '',
            content: newContent.trim()
        };
        displayProgressNotes(notes);
    }
}
</script>
</body>
</html>